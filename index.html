<!DOCTYPE html>                                                                                                                                                                                                                                                                <html lang="en">                                                                                                                                                                                                                                                               <head>                                                                                                                                                                                                                                                                             <meta charset="UTF-8">                                                                                                                                                                                                                                                         <title>Reaction Quotient Calculator</title>                                                                                                                                                                                                                                    <style>                                                                                                                                                                                                                                                                            body {                                                                                                                                                                                                                                                                             font-family: Arial, sans-serif;                                                                                                                                                                                                                                                max-width: 800px;                                                                                                                                                                                                                                                              margin: 20px auto;                                                                                                                                                                                                                                                             padding: 20px;                                                                                                                                                                                                                                                             }                                                                                                                                                                                                                                                                              .input-group {                                                                                                                                                                                                                                                                     margin-bottom: 15px;                                                                                                                                                                                                                                                       }                                                                                                                                                                                                                                                                              input, output, select {                                                                                                                                                                                                                                                            width: 60%;                                                                                                                                                                                                                                                                    padding: 10px;                                                                                                                                                                                                                                                                 border: 1px solid #ccc;                                                                                                                                                                                                                                                        border-radius: 4px;                                                                                                                                                                                                                                                        }                                                                                                                                                                                                                                                                          </style>                                                                                                                                                                                                                                                                   </head>                                                                                                                                                                                                                                                                        <body>                                                                                                                                                                                                                                                                             <h2>Reaction Quotient Calculator (Q)</h2>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     <input type="text" id="reactionFormula" placeholder="Enter reaction formula (e.g., H2O=C=CO2+2H2O)">                                                                                                                                                                           <input type="text" id="formulaDescription" placeholder="Enter reaction description">                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <div id="inputContainer">                                                                                                                                                                                                                                                          <h3>Reaction Input Group</h3>                                                                                                                                                                                                                                                  <div class="input-group">                                                                                                                                                                                                                                                          <label for="addEntry">Add Reaction Entry:</label>                                                                                                                                                                                                                              <input type="text" id="entryLabel" placeholder="Species name (e.g., H2O)" style="color: #666;">                                                                                                                                                                                <input type="number" id="entryValue" step="0.001" placeholder="Concentration or amount">                                                                                                                                                                                       <select id="sideType">=</select>                                                                                                                                                                                                                                           </div>                                                                                                                                                                                                                                                                     </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <button onclick="calculateQ()">Calculate Reaction Quotient Q</button>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         <p><strong>Reaction Formula:</strong> <span id="showFormula"></span></p>                                                                                                                                                                                                       <p><strong>Reaction Quotient (Q):</strong> <span id="showResult"></span></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <script>                                                                                                                                                                                                                                                                           function calculateQ() {                                                                                                                                                                                                                                                            // Clear previous results                                                                                                                                                                                                                                                      document.getElementById('showResult').textContent = '';                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       const reactionFormula = document.getElementById('reactionFormula').value;                                                                                                                                                                                                      const formulaDescription = document.getElementById('formulaDescription').value;                                                                                                                                                                                                                                                                                                                                                                                                                                                                               if (!reactionFormula) {                                                                                                                                                                                                                                                            alert('Please enter a valid reaction formula.');                                                                                                                                                                                                                               return;                                                                                                                                                                                                                                                                    }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             // Split the reaction into reactants and products                                                                                                                                                                                                                              let reactantSide, productSide;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                const splitIndex = reactionFormula.indexOf('=');                                                                                                                                                                                                                               if (splitIndex === -1) {                                                                                                                                                                                                                                                           alert('Invalid reaction format. Please use "=" to separate reactants and products.');                                                                                                                                                                                          return;                                                                                                                                                                                                                                                                    }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             reactantSide = reactionFormula.substring(0, splitIndex);                                                                                                                                                                                                                       productSide = reactionFormula.substring(splitIndex + 1);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      // Process each side                                                                                                                                                                                                                                                           const sides = [];                                                                                                                                                                                                                                                              sides.push({ type: 'reactant', formula: reactantSide });                                                                                                                                                                                                                       sides.push({ type: 'product', formula: productSide });                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Add entries to the input group if provided                                                                                                                                                                                                                                  const entries = document.getElementsByClassName('input-group');                                                                                                                                                                                                                let addedEntries = 0;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         for (let i = 0; i < entries.length; i++) {                                                                                                                                                                                                                                         entries[i].addEventListener('inputchange', function() {                                                                                                                                                                                                                            this.getElementById('sideType').value = 'product';                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Parse the entry                                                                                                                                                                                                                                                             const parts = this.target.split(/(\d+|\.\d+(?:\d*|e-?\d*))?(.*?)=|(.)/);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      if (parts.length === 1) {                                                                                                                                                                                                                                                          return;                                                                                                                                                                                                                                                                    }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             let isReactant = true;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        try {                                                                                                                                                                                                                                                                              const concentration = parseFloat(parts[2]);                                                                                                                                                                                                                                    // Check if the entry contains only numbers                                                                                                                                                                                                                                    if (/^(0|[1-9]\d*)\.?[0-9]*$/.test(parts[2])) {                                                                                                                                                                                                                                    sides[i].type = parts[3] === 'product' ? 'product' : 'reactant';                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              // If it's a number, add to the side with appropriate stoichiometric coefficient                                                                                                                                                                                               if (this.target.match(/^(H2O|H|O|C)$/) !== null) {                                                                                                                                                                                                                                 sides[i].type = parts[3] === 'product' ? 'product' : 'reactant';                                                                                                                                                                                                           } else {                                                                                                                                                                                                                                                                           // This should not happen as we're checking only H, O, and C                                                                                                                                                                                                               }                                                                                                                                                                                                                                                                          }                                                                                                                                                                                                                                                                          } catch (e) {                                                                                                                                                                                                                                                                      alert('Invalid concentration value. Please enter a valid number.');                                                                                                                                                                                                            return;                                                                                                                                                                                                                                                                    }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             sides[i].formula = parts[1];                                                                                                                                                                                                                                                   sides[i].concentration = parseFloat(parts[2]);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // Update the side based on stoichiometric coefficient from reaction formula                                                                                                                                                                                                   if (sides[i].type === 'reactant') {                                                                                                                                                                                                                                                for (let j = 0; j < sides.length; j++) {                                                                                                                                                                                                                                           const currentSide = sides[j];                                                                                                                                                                                                                                                  if (currentSide.type === 'reactant' && parts[3] !== undefined) {                                                                                                                                                                                                                   break;                                                                                                                                                                                                                                                                     } else if (currentSide.type === parts[3] && (j === i || j >= i + 1)) {                                                                                                                                                                                                                 // Update the side's stoichiometric coefficient                                                                                                                                                                                                                                currentSide.stoich = parseInt(parts[4]);                                                                                                                                                                                                                                       break;                                                                                                                                                                                                                                                                 }                                                                                                                                                                                                                                                                          }                                                                                                                                                                                                                                                                          }                                                                                                                                                                                                                                                                          });                                                                                                                                                                                                                                                                        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             // Now process all entries and calculate Q                                                                                                                                                                                                                                     let concentrationsReactants = {};                                                                                                                                                                                                                                              let concentrationsProducts = {};                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              sides.forEach(side => {                                                                                                                                                                                                                                                            if (side.type === 'reactant') {                                                                                                                                                                                                                                                    try {                                                                                                                                                                                                                                                                              const formula = side.formula;                                                                                                                                                                                                                                                  const stoich = side.stoich;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   // Handle pure solids, liquids, etc. by setting their activity to 1                                                                                                                                                                                                            if (/^H2O$/.test(formula) || /^H\+$/test(formula) || /^OH-$/test(formula)) {                                                                                                                                                                                                       concentrationsReactants[formula] = 1;                                                                                                                                                                                                                                      } else {                                                                                                                                                                                                                                                                           const concentration = parseFloat(side.concentration);                                                                                                                                                                                                                          // Apply stoichiometric coefficient                                                                                                                                                                                                                                            if (stoich !== null && stoich !== undefined) {                                                                                                                                                                                                                                     concentrationsReactants[formula] = Math.pow(concentration, stoich);                                                                                                                                                                                                        }                                                                                                                                                                                                                                                                          }                                                                                                                                                                                                                                                                          } catch (e) {                                                                                                                                                                                                                                                                      console.error('Error calculating concentration for:', formula);                                                                                                                                                                                                            }                                                                                                                                                                                                                                                                          } else {                                                                                                                                                                                                                                                                           try {                                                                                                                                                                                                                                                                              const formula = side.formula;                                                                                                                                                                                                                                                  const stoich = side.stoich;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   if (/^H2O$/.test(formula) || /^H\+$/test(formula) || /^OH-$/test(formula)) {                                                                                                                                                                                                       concentrationsProducts[formula] = 1;                                                                                                                                                                                                                                       } else {                                                                                                                                                                                                                                                                           const concentration = parseFloat(side.concentration);                                                                                                                                                                                                                          if (stoich !== null && stoich !== undefined) {                                                                                                                                                                                                                                     concentrationsProducts[formula] = Math.pow(concentration, stoich);                                                                                                                                                                                                         }                                                                                                                                                                                                                                                                          }                                                                                                                                                                                                                                                                          } catch (e) {                                                                                                                                                                                                                                                                      console.error('Error calculating concentration for:', formula);                                                                                                                                                                                                            }                                                                                                                                                                                                                                                                          }                                                                                                                                                                                                                                                                          });                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           // Handle cases where one of the required species is missing                                                                                                                                                                                                                   const allSpecies = Object.keys(concentrationsReactants).concat(Object.keys(concentrationsProducts));                                                                                                                                                                           let denominator = 1;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          for (const spec of Object.keys(concentrationsReactants)) {                                                                                                                                                                                                                         if (!allSpecies.includes(spec) && !allSpecies.includes(spec.replace(/([A-Z])(.)/g, '$1$2')) &&                                                                                                                                                                                     !allSpecies.includes(spec.replace(/([A-Z])([A-Z][A-Z])/g, '$1$2')) && !allSpecies.includes(spec.replace(/([A-Z])([A-Z][A-z])/g, '$1$2'))) {                                                                                                                                    // If the species is not present in either reactants or products, set its concentration to 1                                                                                                                                                                                   concentrationsReactants[spec] = 1;                                                                                                                                                                                                                                         } else if (!concentrationsReactants.hasOwnProperty(spec)) {                                                                                                                                                                                                                        concentrationsReactants[spec] = 1;                                                                                                                                                                                                                                         }                                                                                                                                                                                                                                                                          }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             for (const spec of Object.keys(concentrationsProducts)) {                                                                                                                                                                                                                          if (!allSpecies.includes(spec) && !allSpecies.includes(spec.replace(/([A-Z])(.)/g, '$1$2')) &&                                                                                                                                                                                     !allSpecies.includes(spec.replace(/([A-Z])([A-Z][A-Z])/g, '$1$2')) && !allSpecies.includes(spec.replace(/([A-Z])([A-Z][A-z])/g, '$1$2'))) {                                                                                                                                    concentrationsProducts[spec] = 1;                                                                                                                                                                                                                                          } else if (!concentrationsProducts.hasOwnProperty(spec)) {                                                                                                                                                                                                                         concentrationsProducts[spec] = 1;                                                                                                                                                                                                                                          }                                                                                                                                                                                                                                                                          }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             for (const spec of allSpecies) {                                                                                                                                                                                                                                                   if (concentrationsReactants.hasOwnProperty(spec)) {                                                                                                                                                                                                                                denominator *= Math.pow(concentrationsReactants[spec], stoich);                                                                                                                                                                                                            } else {                                                                                                                                                                                                                                                                           // Handle missing species by setting to activity coefficient 1                                                                                                                                                                                                                 continue;                                                                                                                                                                                                                                                                  }                                                                                                                                                                                                                                                                          }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             const Q = Object.entries(concentrationsProducts).reduce((prod, entry) => {                                                                                                                                                                                                         const spec = entry[0];                                                                                                                                                                                                                                                         const coeff = entry[1];                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       if (concentrationsReactants.hasOwnProperty(spec)) {                                                                                                                                                                                                                                return prod * Math.pow(concentrationsReactants[spec], coeff);                                                                                                                                                                                                              } else {                                                                                                                                                                                                                                                                           return prod;                                                                                                                                                                                                                                                               }                                                                                                                                                                                                                                                                          }, 1);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        document.getElementById('showResult').textContent = `Q = ${Object.entries(concentrationsProducts).reduce((acc, curr) => acc *= curr[1] : 1)}`;                                                                                                                             }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         </script>                                                                                                                                                                                                                                                                  </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <small>Notes:</small>                                                                                                                                                                                                                                                          <ol>                                                                                                                                                                                                                                                                               <li>Pure solids/liquids are assumed to have an activity of 1 and thus do not contribute to the reaction quotient.</li>                                                                                                                                                         <li>Exponents in concentrations are applied based on stoichiometric coefficients from the balanced chemical equation.</li>                                                                                                                                                     <li>This calculator assumes that all entries provided are part of a single balanced equation, with proper separation using "=" between reactants and products.</li>                                                                                                        </ol>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     </body>                                                                                                                                                                                                                                                                        </html>  